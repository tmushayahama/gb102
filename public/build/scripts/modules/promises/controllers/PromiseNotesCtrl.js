angular.module("app.promises").controller("PromiseNotesCtrl",["PromiseNotesManager","$scope","$state","$stateParams","$http","$rootScope","$location","$uibModal","$log","$filter",function(a,b,c,d,e,f,g,h,i,j){var k=this;k.promiseId=d.promiseId,k.promiseNotesCopy,k.promiseNotesManager=new a,k.noteFormDisplay=!1,k.defaultPromiseNoteData={promiseId:d.promiseId,privacy:0},k.newPromiseNoteData=angular.copy(k.defaultPromiseNoteData),k.showNoteForm=function(){k.noteFormDisplay=!0},k.createPromiseNote=function(a){k.promiseNotesManager.createPromiseNote(a).then(function(a){k.noteFormDisplay=!1,k.newPromiseNoteData=angular.copy(k.defaultPromiseNoteData),k.promiseNotesCopy=angular.copy(k.promiseNotesManager.promiseNotes)},function(a){console.log(a)})},k.editPromiseNote=function(a){k.promiseNotesManager.editPromiseNote(a).then(function(a){k.noteFormDisplay=!1,k.newPromiseNoteData=angular.copy(k.defaultPromiseNoteData),k.promiseNotesCopy=angular.copy(k.promiseNotesManager.promiseNotes)},function(a){console.log(a)})},k.editPromiseNoteSections={details:function(a,b){var c={promiseNoteId:a,title:b.title,description:b.description};k.editPromiseNote(c)}},k.cancelPromiseNote=function(a){k.noteFormDisplay=!1,k.newPromiseNoteData=angular.copy(k.defaultPromiseNoteData),a&&(a.$setPristine(),a.$setUntouched())},k.revertPromiseNote=function(a,b){a=b},k.editedNote=null,b.$watch(angular.bind(this,function(){return k.promiseNotes}),function(){k.doneCount=k.promiseNotesManager.promiseNotes.length-k.remainingCount,k.allChecked=!k.remainingCount},!0),k.editNote=function(a){k.editedNote=a,k.originalNote=angular.copy(a)},k.doneEditing=function(a){k.editedNote=null,a.title=a.title.trim(),a.title||k.removeNote(a)},k.openPromiseNote=function(a){var c=h.open({animation:!0,templateUrl:"promise-note-modal.html",controller:"PromiseNoteCtrl as promiseNoteCtrl",backdrop:"static",size:"xl",resolve:{promiseNoteData:function(){return a}}});c.result.then(function(a){b.selected=a},function(){i.info("Modal dismissed at: "+new Date)})},k.promiseNotesManager.getPromiseNotes(k.promiseId)}]);