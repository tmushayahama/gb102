angular.module("app.advices").controller("AdviceCommentsCtrl",["AdviceCommentsManager","$scope","$state","$stateParams","$http","$rootScope","$location","$uibModal","$log","$filter",function(a,b,c,d,e,f,g,h,i,j){var k=this;k.adviceId=d.adviceId,k.adviceCommentsCopy,k.adviceCommentsManager=new a,k.commentFormDisplay=!1,k.defaultAdviceCommentData={adviceId:d.adviceId,privacy:0},k.newAdviceCommentData=angular.copy(k.defaultAdviceCommentData),k.showCommentForm=function(){k.commentFormDisplay=!0},k.createAdviceComment=function(a){k.adviceCommentsManager.createAdviceComment(a).then(function(a){k.commentFormDisplay=!1,k.newAdviceCommentData=angular.copy(k.defaultAdviceCommentData),k.adviceCommentsCopy=angular.copy(k.adviceCommentsManager.adviceComments)},function(a){console.log(a)})},k.editAdviceComment=function(a){k.adviceCommentsManager.editAdviceComment(a).then(function(a){k.commentFormDisplay=!1,k.newAdviceCommentData=angular.copy(k.defaultAdviceCommentData),k.adviceCommentsCopy=angular.copy(k.adviceCommentsManager.adviceComments)},function(a){console.log(a)})},k.editAdviceCommentSections={details:function(a,b){var c={adviceCommentId:a,title:b.title,description:b.description};k.editAdviceComment(c)}},k.cancelAdviceComment=function(a){k.commentFormDisplay=!1,k.newAdviceCommentData=angular.copy(k.defaultAdviceCommentData),a&&(a.$setPristine(),a.$setUntouched())},k.revertAdviceComment=function(a,b){a=b},k.editedComment=null,b.$watch(angular.bind(this,function(){return k.adviceComments}),function(){k.doneCount=k.adviceCommentsManager.adviceComments.length-k.remainingCount,k.allChecked=!k.remainingCount},!0),k.editComment=function(a){k.editedComment=a,k.originalComment=angular.copy(a)},k.doneEditing=function(a){k.editedComment=null,a.title=a.title.trim(),a.title||k.removeComment(a)},k.openAdviceComment=function(a){var c=h.open({animation:!0,templateUrl:"advice-comment-modal.html",controller:"AdviceCommentCtrl as adviceCommentCtrl",backdrop:"static",size:"xl",resolve:{adviceCommentData:function(){return a}}});c.result.then(function(a){b.selected=a},function(){i.info("Modal dismissed at: "+new Date)})},k.adviceCommentsManager.getAdviceComments(k.adviceId)}]);